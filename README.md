# 生产消息

具体原理见代码，有详细注释



# 消费消息



##  消费者组



1. 一个消费者消费四个分区；
2. 一个消费者组中如果有两个消费者，它们同时消费这四个分区：每个消费者消费两个分区
3. 四个消费者消费四个分区：一个消费者消费一个分区
4. 五个消费者消费四个分区：前四个消费者分别消费一个分区，第五个消费者空闲


 建议：
   a)可以通过增加消费者来提升消费性能
   b)consumer消费者数量不能多于分区数量

>Kafka支持一次写入消息，任意多个应用来读取消息

  **如果应用需要读取全量的消息数据，就需要为应用设置一个消费者组**



## Kafka消费消息



### 消费消息的方式

> Kafka中的消费者需要提交位移信息，告诉Kafka，我已经消费到哪一条消息了，然后我就跟着这条消息往后再消费。



1. 自动提交位移
2. 手动提交当前位移（同步）
3. 手动异步提交当前位移
4. 手动异步提交当前位移带回调
5. 混合同步异步提交位移



> 消费者对象不是线程安全的，所以不能有多个线程使用消费者对象



**具体提交方式，见代码**



# 扩展



我们可以自定义序列化器来实现消息的序列化与反序列化。

具体代码：`UserProducer.java` &&`UserConsumer.java`

